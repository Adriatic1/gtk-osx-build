# -*- mode: python -*-

# Edit this file to match your settings and copy it to:
#  ~/.jhbuildrc

# If you have a GNOME svn account, specify it here:
#repos['svn.gnome.org'] = 'svn+ssh://user@svn.gnome.org/svn/'

# What module set should be used. Can be any of the files in the
# modulesets directory, or even the URL of a module set file on a web
# server.
moduleset = 'http://developer.imendio.com/svn/gtk-osx-build/gtk-osx.modules'
#moduleset = 'gtk-osx'

# A list of the modules to build.
modules = [ 'meta-gtk-osx-core' ]

# A list of modules to skip.
skip = [ 'python' ]

# What directory should the source be checked out to?
checkoutroot = os.path.expanduser('~/Source/gnome')
tarballdir = os.path.join(checkoutroot, 'pkgs')

# The prefix to configure/install modules to (must have write access).
prefix = '/opt/gtk'

# Extra arguments to pass to all autogen.sh scripts.
autogenargs='--disable-static --disable-gtk-doc --disable-docs --disable-scrollkeeper'

# Module specific overrides for autogen.sh arguments.
module_autogenargs['gettext'] = autogenargs + ' --without-emacs --disable-java --disable-native-java'
module_autogenargs['doxygen'] = ''

# To set CFLAGS, do this:
#os.environ['CFLAGS'] = '-g -O2'

# Set debugging format to the old one from Tiger and earlier since the
# new default in Leopard breaks many things. Also set gnu89 as the new
# default gnu99 changes how extern inline works, breaking, glib's
# inline setup.
os.environ['CFLAGS'] = '-gstabs+3 -std=gnu89'
os.environ['CXXFLAGS'] = '-gstabs+3'

# On SMP systems you may use something like this to improve
# compilation time: Be aware that not all modules compile correctly
# with make -j2 though, like GTK+.
#os.environ['MAKEFLAGS'] = '-j2'

# Use the included install-check program if available. It won't update
# timestamps if the header hasn't changed, which speeds up builds.
path = os.path.expanduser('~/bin/install-check')
if os.path.exists(path):
    os.environ['INSTALL'] = path

# Can be used to set a different prompt when inside jhbuild shells.
os.environ['INSIDE_JHBUILD'] = '1'

# Hack used in the fake tarballs to install in the right place.
os.environ['PREFIX'] = prefix

os.environ['LIBTOOLIZE'] = prefix + '/bin/libtoolize'

# The -L/-I options are needed for glib etc to pick up gettext
# (libintl), I'm not sure why and I would like to get rid of that.
#
# The option "headerpad_max_install_names" is there to leave some room
# for changing the library locations with install_name_tool.
os.environ['LDFLAGS'] = '-L' + prefix + '/lib' + ' -headerpad_max_install_names'
os.environ['CPPFLAGS'] = '-I' + prefix + '/include'

# Add additional Python path for pygtk since we are using the system
# version.
import sys
version = 'python' + str(sys.version_info[0]) + '.' + str(sys.version_info[1])
os.environ['PYTHONPATH'] = prefix + '/lib/' + version + '/site-packages/gtk-2.0'

os.environ['PERL5LIB'] = prefix + '/lib/perl5/vendor_perl' + ':' + prefix + '/lib/perl5/site_perl'

# Needed to get gtk-doc and other xlstproc using things working.
os.environ['XML_CATALOG_FILES'] = prefix + '/etc/xml/catalog'
